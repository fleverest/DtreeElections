[{"path":"https://fleverest.github.io/elections.dtree/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Floyd Everest. Author, maintainer, copyright holder. Damjan Vukcevic. Author.","code":""},{"path":"https://fleverest.github.io/elections.dtree/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Everest F, Vukcevic D (2023). elections.dtree: Ranked Voting Election Audits Dirichlet-Trees. https://fleverest.github.io/elections.dtree/, https://github.com/fleverest/elections.dtree/.","code":"@Manual{,   title = {elections.dtree: Ranked Voting Election Audits with Dirichlet-Trees},   author = {Floyd Everest and Damjan Vukcevic},   year = {2023},   note = {https://fleverest.github.io/elections.dtree/, https://github.com/fleverest/elections.dtree/}, }"},{"path":[]},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"electionsdtree-audit-ranked-voting-elections-with-dirichlet-trees","dir":"","previous_headings":"","what":"elections.dtree: Audit ranked voting elections with Dirichlet-trees","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"Perform ballot-polling Bayesian audits ranked voting elections using Dirichlet-tree prior distribution.","code":""},{"path":[]},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"cran","dir":"","previous_headings":"Installation","what":"CRAN","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"install latest minor release elections.dtree CRAN:","code":"install.packages(\"elections.dtree\")"},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"github","dir":"","previous_headings":"Installation","what":"GitHub","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"install development release elections.dtree GitHub:","code":"# install.packages(\"remotes\") remotes::install_github(\"fleverest/elections.dtree\")"},{"path":[]},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"why","dir":"","previous_headings":"About the project","what":"Why?","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"Bayesian audits elections typically employ Dirichlet prior, conjugate multinomial distribution observed ballots. ranked voting systems, number ballot types can grow factorially. case instant-runoff voting (IRV), popular type ranked voting system, number possible ballot types n! n candidates (assuming candidates ranked; even greater partially completed ballots permitted). Dirichlet distribution simple effective choice number ballot types small, becomes problematic number gets large. n grows, prior concentration parameters (defined a0 implementation) need order 1 / n! ensure prior overly informative. n large enough, may smaller available precision. Also, fact varies n inconvenient. practical alternative given Dirichlet-tree distribution, implement package. Dirichlet-tree distribution consists nested Dirichlet distributions, arranged hierarchically tree structure. structure represents preference ordering candidates. Branches coming node correspond choices candidate select next preferred, nodes represent ranking candidates (complete ranking leaf nodes, incomplete ranking internal nodes). place Dirichlet distribution node, model conditional split preferences node. structure whole defines Dirichlet-tree distribution. Just like Dirichlet, conjugate multinomial distribution. Also, Dirichlet-tree generalisation, including Dirichlet special case. Using Dirichlet-tree prior distribution allows scale efficiently large n, require setting concentration parameters (a0) values depend n perform well. depend n perform well.","code":""},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"how","dir":"","previous_headings":"About the project","what":"How?","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"package, tree structure implemented nodes initialised appear observed ballot data (.e. least one ballots includes preference sequence represented node). allows memory-complexity O(n*m), m number ballots observed audit process. Without lazy evaluation, memory-complexity necessarily O(n!). Hence, implementation Dirichlet distribution (based reducible Dirichlet-tree structure) enables larger set candidates possible using traditional methods. sample unseen ballots without loading nodes memory, repository implements recursive strategy generates samples starting uninitialized point tree. works well IRV ballot structures, since permutation-tree structure easily navigated given target ballot. Currently, IRV elections implemented, ranked voting systems supported implementing corresponding social choice function. order support different tree structures elections deal high cardinality, similar recursive strategy sampling developed (anyone designing new tree structure consider carefully).","code":""},{"path":[]},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"load-some-data","dir":"","previous_headings":"Usage","what":"Load some data","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"Let’s start downloading data PrefLib using prefio. example, select Wakehurst 2023 dataset containing ballots cast Wakehurst 2023 NSW Legislative Assembly Election. elections NSW Legislative Assembly can found . can see election, voters specify one candidate. Since underlying structure prefio::preferences ranking matrix, can easily find length longest ballot follows: election, maximum ballot length bounded.","code":"wakehurst <- prefio::read_preflib(\"nswla/00058-00000273.soi\", from_preflib = TRUE) head(wakehurst) ##                       preferences frequencies ## 1                 [WILLIAMS Toby]       14115 ## 2                 [REGAN Michael]        8499 ## 3                    [WRIGHT Sue]        3179 ## 4                  [HRNJAK Ethan]        1195 ## 5 [WILLIAMS Toby > REGAN Michael]         976 ## 6 [REGAN Michael > WILLIAMS Toby]         918 max(wakehurst$preferences, na.rm = TRUE) ## [1] 6"},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"specifying-the-prior","dir":"","previous_headings":"Usage","what":"Specifying the prior","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"work dirichlet_trees R, two interfaces disposal. first standard S3 interface R users familiar . second R6 interface can useful like chain commands. ability chain commands, either interface equivalent. , initialise new Dirichlet-tree Wakehurst 2023 election, requiring exactly least one preference specified per formal ballot using prior a0 parameter equal 1.5.","code":"# S3 interface dtree <- dirtree(   candidates = names(wakehurst$preferences),   min_depth = 1,   a0 = 1.5 )  # R6 interface (equivalent to S3) dtree <- dirichlet_tree$new(   candidates = names(wakehurst$preferences),   min_depth = 1,   a0 = 1.5 )  dtree ## Dirichlet-tree (a0=1.5, min_depth=1, max_depth=5, vd=FALSE) ## Candidates: WRIGHT Sue SORENSEN Susan REGAN Michael MAWSON Greg WILLIAMS Toby HRNJAK Ethan ## Observations: ## [1] preferences frequencies ## <0 rows> (or 0-length row.names)"},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"observing-data","dir":"","previous_headings":"Usage","what":"Observing data","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"data observed auditing process formatted prefio::preferences object. Currently, wakehurst object class prefio::aggregated_preferences. also shuffle ballots imitate real auditing scenario sample ballots random. use 1000 ballots ease computation. convert appropriate format shuffle can following: observe first batch say 10 ballots, can update model obtain posterior:","code":"ballots <- sample(prefio::as.preferences(wakehurst))[1:1000] # S3 update(dtree, ballots[1:10])  # R6 dtree$update(ballots[1:10])  # R6 using chained commands dtree <- dirichlet_tree$new(   candidates = names(wakehurst$preferences),   min_depth = 1,   a0 = 1.5 )$update(ballots[1:10])  dtree ## Dirichlet-tree (a0=1.5, min_depth=1, max_depth=5, vd=FALSE) ## Candidates: WRIGHT Sue SORENSEN Susan REGAN Michael MAWSON Greg WILLIAMS Toby HRNJAK Ethan ## Observations: ##                               preferences frequencies ##                           [WILLIAMS Toby]           2 ##                           [REGAN Michael]           1 ##  [HRNJAK Ethan > WRIGHT Sue > MAWSON ...]           1 ##  [WRIGHT Sue > WILLIAMS Toby > REGAN ...]           1 ##                            [HRNJAK Ethan]           1 ##  [WILLIAMS Toby > WRIGHT Sue > REGAN ...]           1 ##  [MAWSON Greg > WRIGHT Sue > SORENSE ...]           1 ##                             [MAWSON Greg]           1 ##  [REGAN Michael > WRIGHT Sue > HRNJA ...]           1"},{"path":"https://fleverest.github.io/elections.dtree/index.html","id":"bayesian-inference-using-the-posterior-dirichlet-tree","dir":"","previous_headings":"Usage","what":"Bayesian inference using the posterior Dirichlet-tree","title":"Ranked Voting Election Audits with Dirichlet-Trees","text":"conduct Bayesian inference using posterior just obtained, can employ monte-carlo simulation simulate unseen ballots determine election outcome many times. can used estimate probability particular candidate goes win election posterior distribution. can also take one realisation posterior distribution examine directly, rather automatically compute simulated election outcome aggregate results. simulate unobserved N = length(ballots) - 10 ballots posterior predictive distribution can run following command: can compute (IRV) election outcome simulation (plus observed data) explicitly like : Finally, can reset model original prior distribution:","code":"# S3 ps <- sample_posterior(dtree, n_elections = 1000, n_ballots = length(ballots))  # R6 ps <- dtree$sample_posterior(n_elections = 1000, n_ballots = length(ballots))  # R6 using chained commands ps <- dirichlet_tree$new(   candidates = names(wakehurst$preferences),   min_depth = 1,   a0 = 1.5 )$update(   ballots[1:10] )$sample_posterior(   n_elections = 100,   n_ballots = length(ballots) )  ps ##   HRNJAK Ethan    MAWSON Greg  REGAN Michael SORENSEN Susan  WILLIAMS Toby  ##           0.20           0.18           0.13           0.02           0.33  ##     WRIGHT Sue  ##           0.14 # S3 simulated <- sample_predictive(dtree, n_ballots = length(ballots) - 10)  # R6 simulated <- dtree$sample_predictive(n_ballots = length(ballots) - 10)  # R6 using chained commands simulated <- dirichlet_tree$new(   candidates = names(wakehurst$preferences),   min_depth = 1,   a0 = 1.5 )$update(   ballots[1:10] )$sample_predictive(n_ballots = length(ballots) - 10)  head(simulated) ##                        preferences frequencies ## 1                    [MAWSON Greg]          81 ## 2                  [REGAN Michael]          48 ## 3                   [HRNJAK Ethan]          31 ## 4                     [WRIGHT Sue]          24 ## 5     [WILLIAMS Toby > WRIGHT Sue]          20 ## 6 [REGAN Michael > SORENSEN Susan]          18 social_choice(   rbind(     ballots[1:10],     prefio::as.preferences(simulated)   ),   sc_function = \"irv\" ) ## $elimination_order ## [1] \"SORENSEN Susan\" \"MAWSON Greg\"    \"WILLIAMS Toby\"  \"REGAN Michael\"  ## [5] \"HRNJAK Ethan\"   ##  ## $winners ## [1] \"WRIGHT Sue\" # S3 reset(dtree)  # R6 dtree$reset()  dtree ## Dirichlet-tree (a0=1.5, min_depth=1, max_depth=5, vd=FALSE) ## Candidates: WRIGHT Sue SORENSEN Susan REGAN Michael MAWSON Greg WILLIAMS Toby HRNJAK Ethan ## Observations: ## [1] preferences frequencies ## <0 rows> (or 0-length row.names)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"dirichlet_tree object represents Dirichlet-tree distribution ballots. specifying tree structure ranked ballots, Dirichlet-tree initialized prior structure described Everest et al. (2022) . methods provided observing data (obtain posterior distribution) along methods sample election outcomes sets ballots posterior predictive distribution.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"R6Class generator object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023). “Ballot-Polling Audits  Instant-Runoff Voting Elections   Dirichlet-Tree Model.” Computer Security. ESORICS 2022 International Workshops, 525--540. ISBN 978-3-031-25460-4. . Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022). “Auditing Ranked Voting Elections Dirichlet-Tree Models: First Steps.” doi:10.15157/diss/021 . .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"active-bindings","dir":"Reference","previous_headings":"","what":"Active bindings","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"a0 Gets sets a0 parameter Dirichlet-tree. min_depth Gets sets min_depth parameter Dirichlet-tree. max_depth Gets sets max_depth parameter Dirichlet-tree. vd Gets sets vd parameter Dirichlet-tree.","code":""},{"path":[]},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"dirichlet_tree$new() dirichlet_tree$print() dirichlet_tree$update() dirichlet_tree$reset() dirichlet_tree$sample_posterior() dirichlet_tree$sample_predictive()","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"Create new dirichlet_tree prior distribution specified tree structure. See Everest et al. (2022)  details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$new(   candidates,   min_depth = 0,   max_depth = length(candidates) - 1,   a0 = 1,   vd = FALSE )"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"candidates character vector, element (must unique) representing single candidate. min_depth minimum number candidates must specified valid ballot election. max_depth maximum number candidates can specified valid ballot election. a0 prior parameter distribution. vd flag , TRUE, employs parameter structure reduces regular Dirichlet distribution described Everest et al. (2022) .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"new dirichlet_tree prior.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dtree <- dirichlet_tree$new(candidates = LETTERS, a0 = 1., min_depth = 1)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-print-","dir":"Reference","previous_headings":"","what":"Method print()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"print shows details distribution parameters.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$print()"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-update-","dir":"Reference","previous_headings":"","what":"Method update()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"Updates dirichlet_tree object observations ballots. updates parameter structure tree yield posterior Dirichlet-tree, described Everest et al. (2022) .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$update(ballots)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"ballots set ballots class `prefio::preferences` `prefio::aggregated_preferences` observe. ballots contain ties, may incomplete.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"examples-1","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS[1:3] )$update(ballots)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-reset-","dir":"Reference","previous_headings":"","what":"Method reset()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"Resets dirichlet_tree observations revert parameter structure back originally specified prior.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$reset()"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"examples-2","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dtree <- dirichlet_tree$new(   candidates = LETTERS )$update(ballots) print(dtree) dtree$reset() print(dtree)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-sample-posterior-","dir":"Reference","previous_headings":"","what":"Method sample_posterior()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"Draws sets ballots independent realizations Dirichlet-tree posterior, determines probability candidate elected aggregating results social choice function. See Everest et al. (2022)  details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$sample_posterior(   n_elections,   n_ballots,   n_winners = 1,   replace = FALSE,   n_threads = NULL )"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"n_elections integer representing number elections generate. higher number yields higher precision output probabilities. n_ballots integer representing total number ballots cast election. n_winners number candidates elected election. replace boolean indicating whether replace sample monte-carlo step, drawing full set election ballots posterior n_threads maximum number threads process. default value NULL default 2 threads. Inf default maximum available, value greater equal maximum available result maximum available.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"numeric vector containing probabilities candidate elected.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"examples-3","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS,   a0 = 1.,   min_depth = 3,   max_depth = 6,   vd = FALSE )$update(   ballots )$sample_posterior(   n_elections = 10,   n_ballots = 10 )"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"method-sample-predictive-","dir":"Reference","previous_headings":"","what":"Method sample_predictive()","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"sample_predictive draws ballots multinomial distribution ballot probabilities obtained single realization Dirichlet-tree posterior ranked ballots. See Everest et al. (2022)  details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"dirichlet_tree$sample_predictive(n_ballots)"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"n_ballots integer representing total number ballots cast election.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"prefio::preferences object containing n_ballots ballots drawn single realisation posterior Dirichlet-tree.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"examples-4","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS,   a0 = 1.,   min_depth = 3,   max_depth = 6,   vd = FALSE )$update(   ballots )$sample_predictive(   n_ballots = 10 )"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirichlet_tree.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Dirichlet-tree for modelling ranked ballots — dirichlet_tree","text":"","code":"## ------------------------------------------------ ## Method `dirichlet_tree$new` ## ------------------------------------------------  dtree <- dirichlet_tree$new(candidates = LETTERS, a0 = 1., min_depth = 1)   ## ------------------------------------------------ ## Method `dirichlet_tree$update` ## ------------------------------------------------  ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS[1:3] )$update(ballots)   ## ------------------------------------------------ ## Method `dirichlet_tree$reset` ## ------------------------------------------------  ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dtree <- dirichlet_tree$new(   candidates = LETTERS )$update(ballots) print(dtree) #> Dirichlet-tree (a0=1, min_depth=0, max_depth=25, vd=FALSE) #> Candidates: Z X Y V T Q O N A C W U D I B H S E F G K J P L R M #> Observations: #>  preferences frequencies #>  [A > B > C]           1 dtree$reset() print(dtree) #> Dirichlet-tree (a0=1, min_depth=0, max_depth=25, vd=FALSE) #> Candidates: Z X Y V T Q O N A C W U D I B H S E F G K J P L R M #> Observations: #> [1] preferences frequencies #> <0 rows> (or 0-length row.names)   ## ------------------------------------------------ ## Method `dirichlet_tree$sample_posterior` ## ------------------------------------------------  ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS,   a0 = 1.,   min_depth = 3,   max_depth = 6,   vd = FALSE )$update(   ballots )$sample_posterior(   n_elections = 10,   n_ballots = 10 ) #>   A   B   C   D   E   F   G   H   I   J   K   L   M   N   O   P   Q   R   S   T  #> 0.3 0.1 0.0 0.1 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.1 0.0 0.0 0.0 0.0 0.1 0.0 0.0  #>   U   V   W   X   Y   Z  #> 0.1 0.0 0.1 0.1 0.0 0.0    ## ------------------------------------------------ ## Method `dirichlet_tree$sample_predictive` ## ------------------------------------------------  ballots <- prefio::preferences(   t(c(1, 2, 3)),   format = \"ranking\",   item_names = LETTERS[1:3] ) dirichlet_tree$new(   candidates = LETTERS,   a0 = 1.,   min_depth = 3,   max_depth = 6,   vd = FALSE )$update(   ballots )$sample_predictive(   n_ballots = 10 ) #>                preferences frequencies #> 1  [H > J > Y > D > B > L]           1 #> 2  [I > Y > Z > G > Q > F]           1 #> 3  [J > X > Y > T > A > P]           1 #> 4  [P > D > V > R > F > J]           1 #> 5  [Q > N > Z > L > W > X]           1 #> 6  [Q > O > L > H > U > J]           1 #> 7  [R > O > B > G > N > D]           1 #> 8  [T > R > K > N > C > V]           1 #> 9          [W > P > A > Y]           1 #> 10 [Y > I > X > S > C > R]           1"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirtree.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Dirichlet-tree object — dirtree","title":"Create a Dirichlet-tree object — dirtree","text":"dirtree used create Dirichlet-tree modelling ballots, described Everest et al. (2022) .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirtree.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Dirichlet-tree object — dirtree","text":"","code":"dirtree(   candidates,   min_depth = 0,   max_depth = length(candidates),   a0 = 1,   vd = FALSE )"},{"path":"https://fleverest.github.io/elections.dtree/reference/dirtree.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Dirichlet-tree object — dirtree","text":"candidates character vector, element (must unique) representing single candidate. min_depth minimum number candidates must specified valid ballot. max_depth maximum number candidates can specified valid ballot. a0 prior parameter distribution. vd flag , TRUE, employs parameter structure reduces regular Dirichlet distribution described Everest et al. (2022) .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirtree.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Dirichlet-tree object — dirtree","text":"Dirichlet-tree representing ranked ballots, object class dirichlet_tree.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/dirtree.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create a Dirichlet-tree object — dirtree","text":"Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023). “Ballot-Polling Audits  Instant-Runoff Voting Elections   Dirichlet-Tree Model.” Computer Security. ESORICS 2022 International Workshops, 525--540. ISBN 978-3-031-25460-4. . Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022). “Auditing Ranked Voting Elections Dirichlet-Tree Models: First Steps.” doi:10.15157/diss/021 . .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/ranked_ballots.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a set of ranked ballots. — ranked_ballots","title":"Construct a set of ranked ballots. — ranked_ballots","text":"Deprecated favour functionality `prefio` package. ranked_ballots used easily construct set ranked ballots.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/ranked_ballots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a set of ranked ballots. — ranked_ballots","text":"","code":"ranked_ballots(x, candidates = NULL, ...)"},{"path":"https://fleverest.github.io/elections.dtree/reference/ranked_ballots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a set of ranked ballots. — ranked_ballots","text":"x character vector representing single ballot, list character vectors representing multiple ballots. candidates character vector names corresponding candidates running election. \\dots Additional parameters pass ranked_ballots.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/ranked_ballots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a set of ranked ballots. — ranked_ballots","text":"ranked_ballots object representing ballot(s).","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/ranked_ballots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a set of ranked ballots. — ranked_ballots","text":"","code":"ranked_ballots(LETTERS[1:5]) #> Warning: `ranked_ballots` is deprecated in favour of `prefio::preferences`. #> [[1]] #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" #>  #> attr(,\"class\") #> [1] \"ranked_ballots\" #> attr(,\"candidates\") #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" ranked_ballots(list(LETTERS[1:5], LETTERS[6:1])) #> Warning: `ranked_ballots` is deprecated in favour of `prefio::preferences`. #> [[1]] #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" #>  #> [[2]] #> [1] \"F\" \"E\" \"D\" \"C\" \"B\" \"A\" #>  #> attr(,\"class\") #> [1] \"ranked_ballots\" #> attr(,\"candidates\") #> [1] \"A\" \"B\" \"C\" \"D\" \"E\" \"F\""},{"path":"https://fleverest.github.io/elections.dtree/reference/read_ballots.html","id":null,"dir":"Reference","previous_headings":"","what":"Read ranked_ballots from a file. — read_ballots","title":"Read ranked_ballots from a file. — read_ballots","text":"Deprecated favour `prefio` plus PrefLib formats. Reads set partial IRV ballots file. file expected follow ballot:count standard, header describing participating candidates.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/read_ballots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read ranked_ballots from a file. — read_ballots","text":"","code":"read_ballots(file)"},{"path":"https://fleverest.github.io/elections.dtree/reference/read_ballots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read ranked_ballots from a file. — read_ballots","text":"file name file read , character vector file lines.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/reset.html","id":null,"dir":"Reference","previous_headings":"","what":"Clear the internal state of a dirichlet_tree object. — reset","title":"Clear the internal state of a dirichlet_tree object. — reset","text":"Destroy Tree's internal state revert back prior.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/reset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clear the internal state of a dirichlet_tree object. — reset","text":"","code":"reset(dtree)"},{"path":"https://fleverest.github.io/elections.dtree/reference/reset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clear the internal state of a dirichlet_tree object. — reset","text":"dtree dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/reset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clear the internal state of a dirichlet_tree object. — reset","text":"dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_posterior.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw election outcomes from the posterior distribution. — sample_posterior","title":"Draw election outcomes from the posterior distribution. — sample_posterior","text":"sample_posterior draws sets ballots independent realizations Dirichlet-tree posterior, determines probability candidate elected aggregating results social choice function. See Everest et al. (2022)  details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_posterior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw election outcomes from the posterior distribution. — sample_posterior","text":"","code":"sample_posterior(   dtree,   n_elections,   n_ballots,   n_winners = 1,   replace = FALSE,   n_threads = NULL )"},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_posterior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw election outcomes from the posterior distribution. — sample_posterior","text":"dtree dirichlet_tree object. n_elections integer representing number elections generate. higher number yields higher precision output probabilities. n_ballots integer representing total number ballots cast election. n_winners number candidates elected election. replace boolean indicating whether re-use observed ballots monte-carlo integration step determine posterior probabilities. n_threads maximum number threads process. default value NULL default 2 threads. Inf default maximum available, value greater equal maximum available result maximum available.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_posterior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw election outcomes from the posterior distribution. — sample_posterior","text":"numeric vector containing probabilities candidate elected.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_posterior.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Draw election outcomes from the posterior distribution. — sample_posterior","text":"Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023). “Ballot-Polling Audits  Instant-Runoff Voting Elections   Dirichlet-Tree Model.” Computer Security. ESORICS 2022 International Workshops, 525--540. ISBN 978-3-031-25460-4. . Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022). “Auditing Ranked Voting Elections Dirichlet-Tree Models: First Steps.” doi:10.15157/diss/021 . .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_predictive.html","id":null,"dir":"Reference","previous_headings":"","what":"Draw ballots from the posterior predictive distribution. — sample_predictive","title":"Draw ballots from the posterior predictive distribution. — sample_predictive","text":"sample_predictive draws ballots multinomial distribution probabilities obtained single realization Dirichlet-tree posterior ranked ballots. See Everest et al. (2022)  details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_predictive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Draw ballots from the posterior predictive distribution. — sample_predictive","text":"","code":"sample_predictive(dtree, n_ballots)"},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_predictive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Draw ballots from the posterior predictive distribution. — sample_predictive","text":"dtree dirichlet_tree object. n_ballots integer representing number ballots draw.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_predictive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Draw ballots from the posterior predictive distribution. — sample_predictive","text":"prefio::preferences object containing n_ballots ballots drawn single realisation posterior Dirichlet-tree.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/sample_predictive.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Draw ballots from the posterior predictive distribution. — sample_predictive","text":"Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023). “Ballot-Polling Audits  Instant-Runoff Voting Elections   Dirichlet-Tree Model.” Computer Security. ESORICS 2022 International Workshops, 525--540. ISBN 978-3-031-25460-4. . Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022). “Auditing Ranked Voting Elections Dirichlet-Tree Models: First Steps.” doi:10.15157/diss/021 . .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/social_choice.html","id":null,"dir":"Reference","previous_headings":"","what":"Election Social Choice Functions — social_choice","title":"Election Social Choice Functions — social_choice","text":"Compute election outcomes ranked ballots variety social choice functions.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/social_choice.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Election Social Choice Functions — social_choice","text":"","code":"social_choice(   ballots,   sc_function = c(\"plurality\", \"irv\", \"stv\"),   n_winners = 1,   ... )"},{"path":"https://fleverest.github.io/elections.dtree/reference/social_choice.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Election Social Choice Functions — social_choice","text":"ballots `prefio::preferences` object containing ballots cast election. sc_function One \"plurality\", \"irv\" \"stv\", corresponding social choice function wish evaluate. n_winners Refers number seats available `sc_function` \"stv\". ... Unused.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/social_choice.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Election Social Choice Functions — social_choice","text":"output depends chosen `sc_function`: \"plurality\" character vector candidate(s) received                       votes. \"irv\" named `list` two objects. First, \"elimination_order\"                 vector eliminated candidate order                 elimination. Second, \"winners\" vector containing                 winning candidate(s). \"stv\" yet implemented.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/tick-sub-.ranked_ballots-tick.html","id":null,"dir":"Reference","previous_headings":"","what":"Access Subsets of Ballots. — `[.ranked_ballots`","title":"Access Subsets of Ballots. — `[.ranked_ballots`","text":"Extract subsets ballots index.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/tick-sub-.ranked_ballots-tick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Access Subsets of Ballots. — `[.ranked_ballots`","text":"","code":"# S3 method for ranked_ballots [(x, i = NULL)"},{"path":"https://fleverest.github.io/elections.dtree/reference/tick-sub-.ranked_ballots-tick.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Access Subsets of Ballots. — `[.ranked_ballots`","text":"x ranked_ballots. index, vector indices corresponding ballot extracted.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/update.html","id":null,"dir":"Reference","previous_headings":"","what":"Update a dirichlet_tree model by observing some ranked ballots. — update","title":"Update a dirichlet_tree model by observing some ranked ballots. — update","text":"update updates Dirichlet-tree model observations obtain posterior distribution ranked ballots. See Everest et al. (2022)  implementation details.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/update.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update a dirichlet_tree model by observing some ranked ballots. — update","text":"","code":"# S3 method for dirichlet_tree update(object, ballots, ...)"},{"path":"https://fleverest.github.io/elections.dtree/reference/update.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update a dirichlet_tree model by observing some ranked ballots. — update","text":"object dirichlet_tree object. ballots set ballots - must type prefio::preferences. \\dots Unused.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/update.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update a dirichlet_tree model by observing some ranked ballots. — update","text":"dirichlet_tree object.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/update.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Update a dirichlet_tree model by observing some ranked ballots. — update","text":"Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2023). “Ballot-Polling Audits  Instant-Runoff Voting Elections   Dirichlet-Tree Model.” Computer Security. ESORICS 2022 International Workshops, 525--540. ISBN 978-3-031-25460-4. . Everest F, Blom M, Stark PB, Stuckey PJ, Teague V, Vukcevic D (2022). “Auditing Ranked Voting Elections Dirichlet-Tree Models: First Steps.” doi:10.15157/diss/021 . .","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/write_ballots.html","id":null,"dir":"Reference","previous_headings":"","what":"Write ranked_ballots to a file. — write_ballots","title":"Write ranked_ballots to a file. — write_ballots","text":"Deprecated favour fucntionality `prefio` package. Writes set ballots new file. follows ballot:count standard, header describing candidates.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/write_ballots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write ranked_ballots to a file. — write_ballots","text":"","code":"write_ballots(ballots, filename = \"\", return_lines = FALSE, suppress = FALSE)"},{"path":"https://fleverest.github.io/elections.dtree/reference/write_ballots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write ranked_ballots to a file. — write_ballots","text":"ballots ranked_ballots write file. filename name file write , \"\" write output stdout. return_lines flag determines whether output returned character vector suppress flag , True, suppresses output stdout.","code":""},{"path":"https://fleverest.github.io/elections.dtree/reference/write_ballots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write ranked_ballots to a file. — write_ballots","text":"","code":"write_ballots(ranked_ballots(c(LETTERS)), tempfile(\"test.txt\")) #> Warning: `write_ballots` is deprecated in favour of `prefio::write_preflib`. #> Warning: `ranked_ballots` is deprecated in favour of `prefio::preferences`. write_ballots(ranked_ballots(c(LETTERS))) #> Warning: `write_ballots` is deprecated in favour of `prefio::write_preflib`. #> Warning: `ranked_ballots` is deprecated in favour of `prefio::preferences`. #> A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z #> A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z #> -+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- #> (A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z) : 1"},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"electionsdtree-200","dir":"Changelog","previous_headings":"","what":"elections.dtree 2.0.0","title":"elections.dtree 2.0.0","text":"Rewrote package use prefio handling ballots. Added function social_choice computing election results explicitly. Improved documentation README.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_112-2-0-0","dir":"Changelog","previous_headings":"","what":"1.1.2","title":"elections.dtree 2.0.0","text":"Improved sample_posterior multithreading remainder spread among worker threads instead entire workload run head process. Fixed issue sampling tree n_ballots parameter set value fewer number observed ballots replacement raises error.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_111-2-0-0","dir":"Changelog","previous_headings":"","what":"1.1.1","title":"elections.dtree 2.0.0","text":"Fixed bug dirichlet_tree$sample_posterior method specifying n_threads=x result x+1 threads spawning.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_110-2-0-0","dir":"Changelog","previous_headings":"","what":"1.1.0","title":"elections.dtree 2.0.0","text":"Added logical parameter replace sample_posterior methods. flag allows sample posterior distribution without reusing ballots sample.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_103-2-0-0","dir":"Changelog","previous_headings":"","what":"1.0.3","title":"elections.dtree 2.0.0","text":"Fixed Multinomial overflow issue libc++, improved documentation.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_102-2-0-0","dir":"Changelog","previous_headings":"","what":"1.0.2","title":"elections.dtree 2.0.0","text":"Patched Dirichlet-Multinomial sampling systems built libc++.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_101-2-0-0","dir":"Changelog","previous_headings":"","what":"1.0.1","title":"elections.dtree 2.0.0","text":"Patched concurrency functionality sample_posterior prevented compilation clang systems.","code":""},{"path":"https://fleverest.github.io/elections.dtree/news/index.html","id":"id_100-2-0-0","dir":"Changelog","previous_headings":"","what":"1.0.0","title":"elections.dtree 2.0.0","text":"Initial release","code":""}]
